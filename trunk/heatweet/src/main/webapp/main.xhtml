<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<script type="text/javascript"
		src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script
		src="http://ajax.googleapis.com/ajax/libs/dojo/1.6.0/dojo/dojo.xd.js"></script>


	<script type="text/javascript">
		var map;
		var G = google.maps;
		var geocoder;
		dojo.ready(initialize);
		function initialize() {
			geocoder = new google.maps.Geocoder();
			var latlng = new google.maps.LatLng(-22.54, -43.13);
			var myOptions = {
				zoom : 8,
				center : latlng,
				mapTypeId : google.maps.MapTypeId.ROADMAP
			};
			map = new google.maps.Map(dojo.byId("map_canvas"), myOptions);



			var layer = new google.maps.FusionTablesLayer({
			  query: {
			    select: 'Geocodable address',
			    from: '139529'
			  },heatmap: {
				    enabled: true
			  }

			});
			layer.setMap(map);

		}
		function codeAddress() {
			var address = dojo.byId("search").value;
			geocoder
					.geocode(
							{
								'address' : address
							},
							function(results, status) {
								if (status == google.maps.GeocoderStatus.OK) {
									map.setCenter(results[0].geometry.location);
									var marker = new google.maps.Marker({
										map : map,
										position : results[0].geometry.location
									});
								} else {
									alert("Geocode was not successful for the following reason: "
											+ status);
								}
							});
		}
	</script>
	<title>A Simple JavaServer Faces 2.0 View</title>
</h:head>
<h:body>
	<h:form id="frm" prependId="false">
		<h:outputScript library="js" name="MCustomTileLayer.js"
			target="head" />
		<h:outputScript library="js" name="MTileLayerControl_v3.js"
			target="head" />
		<div>
			<h:inputText required="true" id="search" value="#{tweetMB.busca}" />
			<h:commandButton value="procurar" action="#{tweetMB.findWoeid}"
				onclick="codeAddress()">
				<f:ajax render="woeid" execute="@form" />type filter text
			</h:commandButton>
			<h:inputHidden id="woeid" value="#{tweetMB.woeid}" />
		</div>
		<div id="controlsDiv" style="border: 1px solid gray"></div>
		<div id="map_canvas" style="width: 800px; height: 500px;"></div>
		<div id="retorno"></div>
	</h:form>
</h:body>
</html>
